'use strict';


// https://learn.microsoft.com/en-us/sql/ado/reference/ado-api/fields-collection-ado?source=recommendations&view=sql-server-ver16
class ADODB_Fields {
    constructor(father) {

        // Instance properties
        // https://learn.microsoft.com/en-us/sql/ado/reference/ado-api/fields-collection-properties-methods-and-events?view=sql-server-ver16#properties

        this._Count = 0;
        this.Count = this._Count;

        this.Item = undefined;

        // Custom properties
        this._items = [];
        this._father = father;
        this._id = _object_id++;
        this._name = "ADODB.Fields[" + this._id + "]";
    }

    // Instance methods
    // https://learn.microsoft.com/en-us/sql/ado/reference/ado-api/fields-collection-properties-methods-and-events?view=sql-server-ver16#methods

    // https://learn.microsoft.com/en-us/sql/ado/reference/ado-api/append-method-ado?view=sql-server-ver16
    Append(object) {
        var newfield = new ADODB_Field(this);
        if (object.length > 0) {
            this._father[object[0]] = undefined;
            newfield.name = object[0]
        }
        if (object.length > 1)
            newfield.type = object[1]
        if (object.length > 2)
            newfield.definedsize = object[2]
        this._father[object[0]] = newfield;
        this._items[this._items.length] = newfield;
    }

    CancelUpdate() { }
    Delete() { }
    Refresh() { }
    Resync() { }
    Update() { }

    // Helper method
    toString() {
        return this._name;
    }
}

ADODB_Fields = new ProxyGenerator(ADODB_Fields);
