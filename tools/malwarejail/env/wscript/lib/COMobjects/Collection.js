// https://learn.microsoft.com/en-us/office/vba/language/reference/user-interface-help/collection-object
Collection = _proxy(function (init = undefined) {
    this.id = _object_id++;
    this._name = "Collection[" + this.id + "]";
    util_log("new " + this._name + "(" + _truncateOutput(_inspect(init)) + ")");
    if (!init)
        this._items = _proxy([]);
    else
        this._items = _proxy(init);

    _defineSingleProperty(this, "count");
    this.count = this._items.length;
    this.add = function (a) {
        util_log(this._name + ".add(" + a + ")");
        this._items[this._items.length] = a;
        this.count = this._items.length;
    }
    this.toString = function () {
        return this._name;
    }
    this.toJSON = function () {
        return this.toString();
    }
    this.inspect = function () {
        return this.toString();
    }
    return this._items;
});
Collection.toString = Collection.toJSON = () => {
    return "Collection";
}
