
// https://learn.microsoft.com/en-us/office/vba/language/reference/user-interface-help/enum-statement
Enumerator = _proxy(function (a) {
    this.id = _object_id++;
    this._enum = a;
    this._index = 0;
    this._name = "Enumerator[" + this.id + "]";
    util_log("new " + this._name + " for " + _truncateOutput(_inspect(a)));
    this.atend = function () {
        var r = (this._index === this._enum.length);
        //util_log(this._name + ".atEnd() => "+ r);
        return r;
    };
    this.movenext = function () {
        this._index++;
    };
    this.item = function () {
        var ret = this._enum[this._index];
        let n = this._name + ".item(" + this._index + ")";
        util_log(n + " => " + _truncateOutput(_inspect(ret)));
        if (typeof ret === 'object')
            ret = _proxy(ret, true, n)
        return ret;
    }
});
Enumerator.toString = Enumerator.toJSON = () => {
    return "Enumerator";
}
Enumerator.prototype.toString = function () {
    return this._name;
}
