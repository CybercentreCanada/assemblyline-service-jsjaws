'use strict';


// https://nodejs.org/api/path.html#pathwin32
const { win32 } = require('path');

// https://learn.microsoft.com/en-us/windows/win32/taskschd/taskservice
class Schedule_Service {
    constructor() {
        // bool Connected () {get}
        this.Connected = undefined;

        // string ConnectedDomain () {get}
        this.ConnectedDomain = undefined;

        // string ConnectedUser () {get}
        this.ConnectedUser = undefined;

        // uint HighestVersion () {get}
        this.HighestVersion = undefined;

        // string TargetServer () {get}
        this.TargetServer = undefined;

        // Custom properties
        this._id = _object_id++;
        this._name = "Schedule.Service[" + this._id + "]";
    }

    // https://learn.microsoft.com/en-us/windows/win32/taskschd/taskservice-connect
    Connect(serverName, user, domain, password) { }

    // https://learn.microsoft.com/en-us/windows/win32/taskschd/taskservice-getfolder
    GetFolder(path) {
        let d1 = win32.normalize(path);
        return new TaskFolder(d1);
    }

    // https://learn.microsoft.com/en-us/windows/win32/taskschd/taskservice-getrunningtasks
    GetRunningTasks(flags) {
        return new Collection([new Win32_Process("app.exe")]);
    }

    // https://learn.microsoft.com/en-us/windows/win32/taskschd/taskservice-newtask
    NewTask(flags) {
        return _proxy(new TaskDefinition());
    }

}

Schedule_Service = new ProxyGenerator(Schedule_Service);
